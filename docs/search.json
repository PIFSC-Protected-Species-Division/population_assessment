[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Assessing the population-level impacts of the U.S. Pacific longline fleet on sea turtles",
    "section": "",
    "text": "Anna Ortega\nCooperative Institute for Marine & Atmospheric Research, University of Hawaiʻi at Mānoa, Honolulu, Hawaiʻi\n\nZachary Siders\nFisheries and Aquatic Sciences Program, University of Florida, Gainesville, Florida\n\nSummer Martin\nProtected Species Division, Pacific Islands Fisheries Science Center, National Marine Fisheries Service, National Oceanic and Atmospheric Administration, Honolulu, Hawaiʻi\n\n\n\n\n\n\n\n\n\n\nSummary\nPopulation assessments are used to inform management by quantifying the negative impact of threats or the positive impact of conservation actions on the long term growth rate and abundance of a population. In this assessment, we examine the impacts of three longline fisheries (the Hawaiʻi-based shallow-set longline fleet, the Hawaiʻi-based deep-set longline fishery, and the American Samoa-based deep-set longline fishery) on two sea turtle species. We estimate the trends and abundance of both North Pacific (NP) loggerhead turtles (Carretta carretta) and the western Pacific (WP) leatherback turtle (Dermochelys coriacea) based on nesting data. The analysis presented here builds on two NOAA Technical Memorandums (NOAA-TM-NMFS-PIFSC-95 and NOAA-TM-NMFS-PIFSC-101) which estimated the impact of the three fisheries above on both NP loggerheads and WP leatherbacks.\nThe goal of this project is to (1) update the previous population assessments with the latest data, (2) expand the population assessment to also capture the positive impact of conservation actions, and (3) provide an open-access workflow of for this population assessment method to be reproduced for other species or regions.\n\n\nR code\nR script files to execute the population assessments described here can be found in the Github repository for this webpage.\n\n\nLicense\nAs a work by US federal employees as part of their official duties, this project is in the public domain within the United States of America. Additionally, we waive copyright and related rights in the work worldwide through the CC0 1.0 Universal public domain dedication.\n\n\nNOAA Disclaimer\nThis repository is a scientific product and is not official communication of the National Oceanic and Atmospheric Administration, or the United States Department of Commerce. All NOAA GitHub project code is provided on an ‘as is’ basis and the user assumes responsibility for its use. Any claims against the Department of Commerce or Department of Commerce bureaus stemming from the use of this GitHub project will be governed by all applicable Federal law. Any reference to specific commercial products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply their endorsement, recommendation or favoring by the Department of Commerce. The Department of Commerce seal and logo, or the seal and logo of a DOC bureau, shall not be used in any manner to imply endorsement of any commercial product or activity by DOC or the United States Government.",
    "crumbs": [
      "Home"
    ]
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "Introduction",
    "section": "",
    "text": "Population viability analysis (PVA) is a conservation tool used to help managers assess extinction risk and guide policy decisions. PVA is mathematical model that uses demographic and life history data to predict the long-term trend of a population, and its sensitivity to changes in life history parameters or environmental stochasticity. This allows users to assess the long-term impact of current threats, such as fisheries bycatch, or conservation actions, such as nesting beach protections.\n\n\nPVA combines two primary components:\n\nRetrospective fitting: Estimating historical trends and current nesting female abundance based on empirical data.\nFuture projections: A simulation approach to evaluate projections against abundance thresholds (the probability of falling below either 50%, 25%, or 12.5% of the current population size).\n\n\n\n\nThis assessment was performed in a Bayesian framework with four main components: nesting data imputation, nesting trend analysis, population viability analysis, and incorporation of fishery take into the PVA (the “take model” component). The Bayesian framework is a statistical method for combining a prior probability (existing knowledge) with new data (likelihood) to produce a revised posterior probability. Instead of using just a single estimate for a PVA, it provides a posterior distribution that quantifies the uncertainty of parameters.\n\n\nSome months were missing from the leatherback dataset, so we used a Bayesian hierarchical model to impute the missing monthly nest counts. This assumes that the dataset contains observed nests, but these values do not fully capture the true number of nests, as not all nests were observed. The relationship between the monthly nest counts recorded on the beach in natural log space (\\(\\text{y}_{t,m}\\)) and the natural log of the true number of nests \\(\\text{X}_{t,m}\\) will be explained below:\nWe model the natural logarithm (natural log) of monthly counts at a nesting beach as an auto-regressive model. \\[\n\\text{u}_{t,m} = \\text{s}_{t,m} + \\text{X}_{t-1,m-1}\n\\] \\(\\text{u}_{t,m}\\) is the mean of the natural log of the true number of nests at time \\(t\\) of month \\(m\\), \\(\\text{s}_{t,m}\\) is the “slope” parameter at time \\(t\\), which is defined by month (\\(m\\) = 1 to 12). \\(\\text{X}_{t-1,m}\\) is the natural log of the true nest count at time \\(t - 1\\). While month index \\(m\\) corresponds to sequential months in each nesting season (e.g. months 1 through 12), the time index starts at the first month of the time series and increases monthly throughout all years in the time series.\nThe state-space \\(\\text{X}_{t,m}\\) is modeled with a normal distribution with the mean \\(\\text{u}_{t,m}\\) and standard deviation \\(\\sigma_X\\), which was assumed to be constant over time. \\[\n\\text{X}_{t,m} \\text~N(\\text{u}_{t,m},\\sigma_X)\n\\] Observations \\(\\text{y}_{t,m}\\) are modeled with another normal distribution with standard deviation \\(\\sigma_y\\). also assumed to be constant over time. \\[\n\\text{y}_{t,m} \\text~N(\\text{X}_{t,m},\\sigma_y)\n\\] The slope \\(\\text{s}_{t,m}\\) parameters are modeled with the discrete Fourier series y acknowledging the periodicity of nesting. For Jamursba Medi, a 12-month period captures the single summer peak in nesting, whereas the summer and winter peaks of nesting in Wermon are captured by a 6-month period. \\[\n\\text{s}_{t,m} = \\beta_1 * cos(2\\pi(\\frac{m}{period})) + \\beta_2 * sin(2\\pi(\\frac{m}{period})\n\\] The two coefficients (\\(\\beta_1\\) and \\(\\beta_2\\)) were estimated from the data. The annual number of nests for each season (April through March; \\(X_T\\)) are computed as the sum of estimated true monthly log numbers of nests (\\(\\text{X}_{t,m}\\)), derived from imputed log observed nest counts (\\(\\text{y}_{t,m}\\)). \\[\nX_T = \\sum{exp(\\text{X}_{.,m}})\n\\] \\(\\text{X}_{.,m}\\) indicates all \\(t\\) values from \\(m\\) = 1 to \\(m\\) = 12.\nPrior distributions for the parameters are not flat but with large uncertainties in the natural log space. Normal distributions with mean = 0 and variance = 1 are used for the two parameters for the Fourier discrete function (\\(\\beta_1, \\beta_2\\)), whereas gamma distributions with the shape parameter = 2 and rate parameter = 0.5 are used for the standard deviation parameters for the process (\\(\\sigma_X\\)) and observation (\\(\\sigma_y\\)) models.\n\n\n\nPopulation growth rates are estimated using a stochastic density-independent exponential growth model applied to nest count data (Boyd et al. 20171, Holmes et al. (2007)2. \\[\nN_j = \\text{N}_{j-1}e^r\n\\] \\(N_j\\) is the number of Annual Nesters in the year \\(j\\), \\(r\\) is the instantaneous population growth rate (i.e. long-term annual trend), and \\(e^r\\) = \\(\\lambda\\) (i.e., “lambda”, the finite rate of increase for the population).\nThis model is common for long-lived, slow-growing, late-maturing species such as sea turtles, whose populations have been depleted to relatively low levels. The assumption of density-independence could be evaluated in future by running a density-dependent model (e.g. Gompertz model), which would allow the population to reach carrying capacity at some point in the future.\nThe data inputs to the model were the time series of Annual Nesters, or the number of females arriving on a beach to nest each year. These were derived from observed nest counts, by dividing each nest count by mean clutch frequency (i.e. the mean number of clutches per nesting female in a nesting season). This static conversion does not affect the estimation process, but puts results into management-relevant terms. The number of Annual Nesters summed across one remigration interval (i.e. the number of years between nesting events of the same female) yields a snapshot of the Total Nesters in the population.\nThe trend estimates here are better interpreted as long-term annual trends in the number of nesters, rather than the true population growth rates. This is because the model relies exclusively on nest count data, nesters only represent a small portion of the total population that includes males and immature turtles of both sexes, and assuming true population growth rates would require the assumption of a stable age distribution, for which no data exists.\nThe exponential growth rate was transformed into natural log space and solved for the population growth rate: \\[\nln(N_j) = ln(\\text{N}_{j-1}) + r\n\\] \\[\nr = ln(N_j) - ln(\\text{N}_{j-1})\n\\] Following Boyd et al. (2017)3, we construct a Bayesian state-space model (BSSM) from the natural log version of the exponential population growth equation. The BSSM allows for estimation of process variation (i.e., environmental and demographic variability) and observation uncertainty (i.e., imperfect data collection) and provides posterior distributions (i.e., parameter estimates with probability distributions) which are useful for conveying uncertainty in management applications.\nThere are two major components of the BSSM: the process model describing the true number of nesting females each year, and the observation model relating the observed count data to the true number of nesting females. Three parameters are estimated: \\(r\\), the instantaneous population growth rate, \\(Q\\), the process error variance, and \\(R\\), the observation error variance. The model also provides a predicted count with a probability distribution for each year of observed data. The predicted value for the final year of observed data is then used as a starting point for future projections.\n\\[\n\\text{Process equation:}\\quad {T_j = \\text{T}_{j-1} + r + p_j} \\quad \\text{where}\\; p_j \\,\\text ~\\, N(0,Q)\n\\] Where \\(T_j\\) is the natural log of the true number of annual nesters in year \\(j\\), \\(r\\) is the instantaneous population growth rate, \\(p_j\\) is the process error at year \\(j\\), and \\(Q\\) is the state process (time invariant). The true state variable, \\(T_j\\) is not directly measured for the MP loggerheads nor WP leatherbacks. Instead, nest counts are observed on multiple beaches for each population, and the resulting time series come with various forms of observation uncertainty (i.e., missed nests or falsely identified nests). The relationship between the observed data and the corresponding number of true Annual Nesters is defined by a second equation: \\[\n\\text{Observation equation:}\\quad {B_j = T_j + o_j} \\quad \\text{where}\\; o_j \\,\\text ~\\, N(0,R)\n\\] where \\(B_j\\) is the natural log of the observed nesters, \\(o_j\\) is the observation error at year \\(j\\), and \\(R\\) is the variance of the observation process (time invariant).\nFor both NP loggerheads and WP leatherbacks, we define the model to only have one population with multiple time series of observations (i.e., multiple beaches).This structure best represents the known population dynamics of genetic similarity and exchange of individuals across the studied beaches.\nHowever, the basic model can be expanded to accommodate multiple state vectors, representing several populations and multiple time series (Hinrichsen and Holmes 20094): \\[\n\\text{Process equation:}\\quad {T_j = \\text{T}_{j-1} + r + p_j} \\quad \\text{where}\\; p_j \\,\\text ~\\, MVN(0,Q_j)\n\\] \\[\n\\text{Observation equation:}\\quad {B_j = Z +T_j + a + o_j} \\quad \\text{where}\\; o_j \\,\\text ~\\, MVN(0,R_j)\n\\] where \\(Q_j\\) is the process variance-covariance matrix, \\(R_j\\) is the observation variance-covariance matrix, \\(Z\\) is a matrix that maps sets of time series to the set of state vectors, and \\(a\\) is a vector of scaling parameters. The multivariate setting would allow the analysis of each time series as an individual population.\nPosterior distributions of the model parameters are numerically derived using Markov chain Monte Carlo (MCMC) simulation in JAGS (Plummer, 20035; 20176).The MCMC simulations are based on 10,000 samples of 2 chains. Every other sample was retained to reduce auto-correlation, and the first 1000 samples of each chain were discarded as burn-in.\nFrom the model outputs, we are most interested in \\(r\\), the annual population growth rate, \\(Q\\), the process variance, and \\(\\text{T}_{final}\\), the estimated true log Annual Nesters for the final year of observed data. Posterior distributions of Annual Nesters for the final found years of data are used to estimate current abundance: \\[\n\\text{N}_{current} = \\frac{RI * (e^{\\text{T}_{final}})+(e^{\\text{T}_{final-1}})+(e^{\\text{T}_{final-2}})+(e^{\\text{T}_{final-3}})}{4}\n\\] where \\(RI\\) is the remigration interval for the population and \\(\\text{N}_{final}\\) is the median Annual Nesters estimated for the final year of data, \\(\\text{N}_{final-1}\\) is for the second to final year of data, and so on. This serves as a snapshot of Total Reproductive Females in the population, and assumes no mortaily of adults females during the \\(RI\\) period.\n\n\n\nPVA projections use a simulation approach with 10,000 runs for each species. Each projection is initialized in its starting year with a paired draw from the MCMC samples (joint posterior distribution) for (1) Annual Nesters (\\(N_0\\) = \\(\\text{N}_{final}\\)), (2) instantaneous population growth rate (\\(r\\)), (3) process error variance (\\(Q\\)) from the final data year of the historic trend analysis. For each subsequent year in the projection, a new \\(r\\) and \\(Q\\) are drawn as pairs from the MCMC samples to make the projections dynamic. Pulling paired draws from the MCMC samples reflects the inter-annual variation in the biology of the species, but also constrains parameter values to realistic combinations and therefore keeps the uncertainty in the projections reasonable.\nProjections can be evaluated against abundance thresholds. Here, the probability of falling below 50%, 25%, and 12.5% of current population size (\\(N_0\\)) is calculated at 5, 10, 25, 50, and 100-year time steps by summing the number of projections below the thresholds at the given time step and dividing by the total number of projections (10,000). Mean, median, and 95% confidence limits of number of years to reach the threshold are calculated for simulations that fall below a given population threshold, and the 100-year timestep simulation.\n\n\n\nIn principle, the incorporation of fisheries interactions into the PVA projections is simple: during the calculation of the number of females in the next time step (\\(\\text{N}_{j+1}\\)), the number of females in the current time step (\\(N_j\\)) is reduced by the incidental take in the current time step (\\(F_j\\)) and multiplied by the finite population growth rate (\\(\\lambda\\), = \\(e^r\\)). \\[\n\\text{N}_{j+1} = (N_j - F_j) * e^r\n\\] Therefore, the challenge comes from converting the incidental take of a given species (comprised of various lengths, ages, life stages, and sexes) to adult nester equivalents (ANE).\n1. Predicting anticipated take levels: The first goal is to generate the number and characteristics of the anticipated turtles that will be taken in each year. The number of turtles is referred to as the anticipated take level (ATL). Each year’s ATL was drawn from a Conway-Maxwell Poisson distribution (CMP), a two-parameter version of the Poisson distributions that includes a scale parameter \\(\\nu\\). \\(\\mu_{s,j}\\) is the mean of the CMP distribution, and \\(s\\) is one of three within-year segments which are summed to produce the total annual ATL (McCracken 20187). \\[\n\\text{ATL}_{j} \\; \\text~ \\sum^{3}_{s=1}{CMP(\\mu_{s,j},\\nu_{s,j})}\n\\] Each individual in the annual ATL receives (1) a length and fishery mortality from a bivariate normal distribution, (2) a back-calculated age with years until maturity based on a von Bertalanffy growth model, (3) juvenile survival rate, (4) sex, and (5) a remigration interval.\n2. Lengths and fishery mortality. Based on historic incidental take, a bivariate normal distribution is used to generate lengths in logarithmic space and assign fishery mortality in logit space. \\(\\theta_{L,j}\\) is a linear function of the annual incidental take (\\(F_j\\)) with intercept \\(a_0\\) and slope \\(a_1\\), and \\(\\sum\\) is the variance-covariance matrix with variances \\(\\sigma_L^2\\) and \\(\\sigma_D^2\\) for the log lengths (log(\\(L_k\\))) and logit assigned fishery mortality (logit(\\(D_k\\))) to have correlated draws. The parameters of the multivariate normal distribution (\\(a_0, a_1, \\sigma_L, \\sigma_D, \\rho_{L,D}\\)) are solved for in a Bayesian framework using STAN via RStan with 7,500 simulations per chain (5,000 burn-in, 2,500 retained) with 4 chains. \\[\n\\left( \\frac{log(L_k)}{logit(D_k)} \\right) \\;\\text~MVN\\left(\\frac{\\theta_{L,j}}{\\theta_D},\\;\\scriptstyle\\sum\\;\\right)\n\\] \\[\n\\theta_{L,j} = a_0 + a_1F_j\n\\]\n\\[\n\\scriptstyle\\sum = \\left[\\frac {\\sigma_L^2}{}{\\rho_{L,d}{}} \\right]\n\\] \\[\n\\Sigma = \\begin{pmatrix}\n\\mathrm{\\sigma_L^2} & \\mathrm{{\\rho_{L,D}}{\\sigma_{L}{\\sigma_{D}} \\\\\n\\mathrm{{\\rho_{L,D}}{\\sigma_L}{\\sigma_D}} & \\mathrm{\\sigma_D^2}\n\\end{pmatrix}\n\\]\n3. Age and stage. From all lengths of historically taken turtles, a von Bertalanffy growth model (VBGM) is used to calculate the expected length at age across the range of lengths for each species. Using the VBGM for each species, the age at maturity (\\(A_{mat}\\)) was assumed to correspond to a length of 97.5% of the maximum asymptotic maximum length (\\(L_\\infty\\)). Turtles with ages less than \\(A_{mat}\\) or lengths less than 97.5% of (\\(L_\\infty\\)) are considered immature. Years until maturity are calculated for all turtles as \\(Y_k = A_{mat} - {A_k}\\), where \\(A_k\\) is the age of the \\(k\\)th individual.\n4. Remigration interval, juvenile survival, and sex. In deterministic runs, each individual in the anticipated take is assigned the mean remigration interval (\\(RI\\)) and the mean juvenile survival (\\(\\phi\\)). In stochastic runs, each individual’s \\(RI\\) is drawn from a distribution (CMP for leatherbacks, truncated normal for loggerheads) and their juvenile survival is drawn from a normal distribution. The sex of each animal is drawn from a Bernoulli distribution for the probability of being female.\n5. ANE calculation. Adults in the anticipated take are given ANEs of 1. Juvenile ANEs are calculated by projecting the juvenile survival over the number of years to maturity, and dividing by remigration interval. The stochastic nature of sex ratio and fishery mortality are applied to adjust the individual ANE. The probability of an individual taken by a fishery dying is used with a Bernoulli distribution to simulate whether an individual dies. Therefore, the ANE of the \\(k\\)th individual is computed such that when the individual was a juvenile, female, and ended up dying, ANE was defined as the first equation below. However, when the individual was adult and either male or ends up alive, the ANE equals 0.\n\\[\nANE_k = \\frac{\\phi_J^{Y_k}}{RI}\n\\] \\[\nANE_{realized,k} = \\{{{\\frac{\\phi_J^{Y_k}}{RI}, Stage = J}\\atop{1 \\times Sex \\times Discard, Stage = A}}\n\\] 5. Historical ANE imputation. To account for the historical impact on the population growth rates, ANE is also calculated historically. Each turtle’s length is used to generate a likely age, stage, and years to maturity. Juveniles’ years to maturity are rounded to the nearest year, and adults are assumed to be nesting in the year of their fishery interaction. \\(Y_F\\) is the year incidental take occurred, \\(Y_k\\) is the yeras to maturity, RI is the remigration interval (rounded to 3 years). The survival probability between each nesting year has to be accounted for so that the initial ANE is adjusted, where \\(\\phi_J\\) and \\(\\phi_A\\) are juvenile and adult survival rates, \\(PF\\) is the proportion females, and \\(D\\) is the assigned fishery mortality. \\[\nY_{nest,k} = \\{{{Y_F+Y_k, y=1}\\atop{Y_{nest,k}-1+RI, y&gt;1}}\n\\] \\[\nANE_{k,j} = \\{{{{\\phi_J^{Nest_1}}\\times{PF} \\times D_k, y = 1}\\atop{{\\phi_A^{RI}, y&gt;1}}}\n\\] 6. Take calculation. After converting all individuals to ANEs, take (\\(F_j\\)) from the earlier equation is substituted out for the summation of the individual ANEs in a given year. To account to process variance \\(Q\\) from the trend analysis, the first equation below is modified to draw \\(N_{j+1}\\) from a normal distribution. The modified population growth model presented below is used as the basis for the future projections described above to produce future scenarios with take incorporated. \\[\n\\text{N}_{j+1} = (N_j - ANE_{realized,j}) * e^r\n\\] \\[\n\\text{N}_{j+1} = N((N_j - ANE_{realized,j}) * e^r, Q)\n\\]\n\n\n\nImputation:\n\nThe true number of nests per month is distributed normally, where the monthly means can be modeled with a discrete Fourier series with a fixed annual frequency. In other words, the number of peaks within a year is constant over the years. The variance around the means is assumed constant over the years.\nWe used an autoregressive model with a lag of one month (AR1 model) where the relationship between the numbers of nests in two months is modeled by the Fourier series. We assume this model sufficiently captures the cyclical nature of nesting throughout the year.\n\nTrend:\n\nThe proportion of total nests observed on a given beach is constant through time.\nThe time series of observed number of annual nesters are representative of the populations, as are the population growth rates observed for nesters. Note that index beaches are typically identified for long-term monitoring because they represent the population well.\nThe clutch frequency is constant through time.\nThe population growth rate is density-independent for each species (i.e., no carrying capacity or Allee effects in the timeframe considered).\nThe population growth rate is the same across the different beaches for each species (i.e., there is a single biological process resulting in a single trend).\nThe process and observation variances are estimable (with so few beaches, the prior has a lot of influence).\nThe index beaches in both Japan and Indonesia were observed with constant effort or were effort-corrected by the data collectors prior to being provided to PIFSC to form the time series used in these analyses.\nThe remigration interval is constant through time.\n\nProjections:\n\nThe population will face the same threats in the future as it did in the past. The PVA applies the population growth rate from the past, which was influenced by some particular magnitude of threats, to the future trajectory of the population. It does not account for the impacts of new or increasing threats, such as the loss of nesting habitat from climate change.\n\nTake model:\n\nThe anticipated take level (ATL) is constant through time and independent of fishery effort. This assumption was made by McCracken (2018) when generating the ATLs for the fishery.\nThe distribution of turtles’ sizes and post-interaction mortalities in the past is representative of what will be encountered in the future. We make this assumption when we use the fisheries observer data to inform characteristics of future turtles taken by the fishery, and do so because these are the best available data for the task.\nThe life history parameters are indicative of the populations of interest and are estimated accurately. Specifically, Amat(age at maturity) is 0.975 of Linf (asymptotic length; average length of mature females).\nTurtles will nest immediately once they reach maturity.\n\n\n\n\nWe made a number of decisions in the analyses that were inherently conservative for the turtle species in question (i.e., likely inflated the mortality relative to the true). We highlight those here to provide context for interpretation:\n\nWe applied the entire anticipated take for the fishery in future years to the index beaches for which we had data; however, those index beaches represent only 52% and 75% of the nesting populations for loggerheads and leatherbacks, respectively. Assessing the impact of the entire take on the index beach populations rather than the full populations is conservative for the species.\nThe Bayesian trend analysis accounts for the parameter uncertainty by incorporating estimated uncertainty of demographic parameters. Consequently, we found large uncertainty around the estimated population growth rate (r), which resulted in greater or lesser chance of recovering than what was found from a frequentist approach. This finding provides an accurate assessment of the projected population given what we know about the population.\nThe anticipated take level is biased high (the CMP distribution tends to draw ATLs that are higher than the take levels observed in previous years).\nIn calculating Adult Nester Equivalents (ANEs) in our historical analysis of fishery impacts (see Historical ANE Imputation), we assume that nesters would have repeatedly returned to nest at a constant remigration interval with an annual probability of survival equal to 0.89 for leatherbacks and 0.90 for loggerheads. However, for loggerheads, Japanese colleagues have indicated that nesters have a relatively low probability of being observed nesting in future years after their initial sighting (approximately 0.30), suggesting potentially high threats in the marine environment. If this is true, then the ANE values in our historical analysis (see Historical ANE Imputation) are inflated compared to the true ANE values (i.e., we added back loggerhead nesters to the population when in reality they had a low chance of surviving to the next nesting season)."
  },
  {
    "objectID": "about.html#conceptual-framework",
    "href": "about.html#conceptual-framework",
    "title": "Introduction",
    "section": "",
    "text": "PVA combines two primary components:\n\nRetrospective fitting: Estimating historical trends and current nesting female abundance based on empirical data.\nFuture projections: A simulation approach to evaluate projections against abundance thresholds (the probability of falling below either 50%, 25%, or 12.5% of the current population size)."
  },
  {
    "objectID": "about.html#methods-outline",
    "href": "about.html#methods-outline",
    "title": "Introduction",
    "section": "",
    "text": "This assessment was performed in a Bayesian framework with four main components: nesting data imputation, nesting trend analysis, population viability analysis, and incorporation of fishery take into the PVA (the “take model” component). The Bayesian framework is a statistical method for combining a prior probability (existing knowledge) with new data (likelihood) to produce a revised posterior probability. Instead of using just a single estimate for a PVA, it provides a posterior distribution that quantifies the uncertainty of parameters.\n\n\nSome months were missing from the leatherback dataset, so we used a Bayesian hierarchical model to impute the missing monthly nest counts. This assumes that the dataset contains observed nests, but these values do not fully capture the true number of nests, as not all nests were observed. The relationship between the monthly nest counts recorded on the beach in natural log space (\\(\\text{y}_{t,m}\\)) and the natural log of the true number of nests \\(\\text{X}_{t,m}\\) will be explained below:\nWe model the natural logarithm (natural log) of monthly counts at a nesting beach as an auto-regressive model. \\[\n\\text{u}_{t,m} = \\text{s}_{t,m} + \\text{X}_{t-1,m-1}\n\\] \\(\\text{u}_{t,m}\\) is the mean of the natural log of the true number of nests at time \\(t\\) of month \\(m\\), \\(\\text{s}_{t,m}\\) is the “slope” parameter at time \\(t\\), which is defined by month (\\(m\\) = 1 to 12). \\(\\text{X}_{t-1,m}\\) is the natural log of the true nest count at time \\(t - 1\\). While month index \\(m\\) corresponds to sequential months in each nesting season (e.g. months 1 through 12), the time index starts at the first month of the time series and increases monthly throughout all years in the time series.\nThe state-space \\(\\text{X}_{t,m}\\) is modeled with a normal distribution with the mean \\(\\text{u}_{t,m}\\) and standard deviation \\(\\sigma_X\\), which was assumed to be constant over time. \\[\n\\text{X}_{t,m} \\text~N(\\text{u}_{t,m},\\sigma_X)\n\\] Observations \\(\\text{y}_{t,m}\\) are modeled with another normal distribution with standard deviation \\(\\sigma_y\\). also assumed to be constant over time. \\[\n\\text{y}_{t,m} \\text~N(\\text{X}_{t,m},\\sigma_y)\n\\] The slope \\(\\text{s}_{t,m}\\) parameters are modeled with the discrete Fourier series y acknowledging the periodicity of nesting. For Jamursba Medi, a 12-month period captures the single summer peak in nesting, whereas the summer and winter peaks of nesting in Wermon are captured by a 6-month period. \\[\n\\text{s}_{t,m} = \\beta_1 * cos(2\\pi(\\frac{m}{period})) + \\beta_2 * sin(2\\pi(\\frac{m}{period})\n\\] The two coefficients (\\(\\beta_1\\) and \\(\\beta_2\\)) were estimated from the data. The annual number of nests for each season (April through March; \\(X_T\\)) are computed as the sum of estimated true monthly log numbers of nests (\\(\\text{X}_{t,m}\\)), derived from imputed log observed nest counts (\\(\\text{y}_{t,m}\\)). \\[\nX_T = \\sum{exp(\\text{X}_{.,m}})\n\\] \\(\\text{X}_{.,m}\\) indicates all \\(t\\) values from \\(m\\) = 1 to \\(m\\) = 12.\nPrior distributions for the parameters are not flat but with large uncertainties in the natural log space. Normal distributions with mean = 0 and variance = 1 are used for the two parameters for the Fourier discrete function (\\(\\beta_1, \\beta_2\\)), whereas gamma distributions with the shape parameter = 2 and rate parameter = 0.5 are used for the standard deviation parameters for the process (\\(\\sigma_X\\)) and observation (\\(\\sigma_y\\)) models.\n\n\n\nPopulation growth rates are estimated using a stochastic density-independent exponential growth model applied to nest count data (Boyd et al. 20171, Holmes et al. (2007)2. \\[\nN_j = \\text{N}_{j-1}e^r\n\\] \\(N_j\\) is the number of Annual Nesters in the year \\(j\\), \\(r\\) is the instantaneous population growth rate (i.e. long-term annual trend), and \\(e^r\\) = \\(\\lambda\\) (i.e., “lambda”, the finite rate of increase for the population).\nThis model is common for long-lived, slow-growing, late-maturing species such as sea turtles, whose populations have been depleted to relatively low levels. The assumption of density-independence could be evaluated in future by running a density-dependent model (e.g. Gompertz model), which would allow the population to reach carrying capacity at some point in the future.\nThe data inputs to the model were the time series of Annual Nesters, or the number of females arriving on a beach to nest each year. These were derived from observed nest counts, by dividing each nest count by mean clutch frequency (i.e. the mean number of clutches per nesting female in a nesting season). This static conversion does not affect the estimation process, but puts results into management-relevant terms. The number of Annual Nesters summed across one remigration interval (i.e. the number of years between nesting events of the same female) yields a snapshot of the Total Nesters in the population.\nThe trend estimates here are better interpreted as long-term annual trends in the number of nesters, rather than the true population growth rates. This is because the model relies exclusively on nest count data, nesters only represent a small portion of the total population that includes males and immature turtles of both sexes, and assuming true population growth rates would require the assumption of a stable age distribution, for which no data exists.\nThe exponential growth rate was transformed into natural log space and solved for the population growth rate: \\[\nln(N_j) = ln(\\text{N}_{j-1}) + r\n\\] \\[\nr = ln(N_j) - ln(\\text{N}_{j-1})\n\\] Following Boyd et al. (2017)3, we construct a Bayesian state-space model (BSSM) from the natural log version of the exponential population growth equation. The BSSM allows for estimation of process variation (i.e., environmental and demographic variability) and observation uncertainty (i.e., imperfect data collection) and provides posterior distributions (i.e., parameter estimates with probability distributions) which are useful for conveying uncertainty in management applications.\nThere are two major components of the BSSM: the process model describing the true number of nesting females each year, and the observation model relating the observed count data to the true number of nesting females. Three parameters are estimated: \\(r\\), the instantaneous population growth rate, \\(Q\\), the process error variance, and \\(R\\), the observation error variance. The model also provides a predicted count with a probability distribution for each year of observed data. The predicted value for the final year of observed data is then used as a starting point for future projections.\n\\[\n\\text{Process equation:}\\quad {T_j = \\text{T}_{j-1} + r + p_j} \\quad \\text{where}\\; p_j \\,\\text ~\\, N(0,Q)\n\\] Where \\(T_j\\) is the natural log of the true number of annual nesters in year \\(j\\), \\(r\\) is the instantaneous population growth rate, \\(p_j\\) is the process error at year \\(j\\), and \\(Q\\) is the state process (time invariant). The true state variable, \\(T_j\\) is not directly measured for the MP loggerheads nor WP leatherbacks. Instead, nest counts are observed on multiple beaches for each population, and the resulting time series come with various forms of observation uncertainty (i.e., missed nests or falsely identified nests). The relationship between the observed data and the corresponding number of true Annual Nesters is defined by a second equation: \\[\n\\text{Observation equation:}\\quad {B_j = T_j + o_j} \\quad \\text{where}\\; o_j \\,\\text ~\\, N(0,R)\n\\] where \\(B_j\\) is the natural log of the observed nesters, \\(o_j\\) is the observation error at year \\(j\\), and \\(R\\) is the variance of the observation process (time invariant).\nFor both NP loggerheads and WP leatherbacks, we define the model to only have one population with multiple time series of observations (i.e., multiple beaches).This structure best represents the known population dynamics of genetic similarity and exchange of individuals across the studied beaches.\nHowever, the basic model can be expanded to accommodate multiple state vectors, representing several populations and multiple time series (Hinrichsen and Holmes 20094): \\[\n\\text{Process equation:}\\quad {T_j = \\text{T}_{j-1} + r + p_j} \\quad \\text{where}\\; p_j \\,\\text ~\\, MVN(0,Q_j)\n\\] \\[\n\\text{Observation equation:}\\quad {B_j = Z +T_j + a + o_j} \\quad \\text{where}\\; o_j \\,\\text ~\\, MVN(0,R_j)\n\\] where \\(Q_j\\) is the process variance-covariance matrix, \\(R_j\\) is the observation variance-covariance matrix, \\(Z\\) is a matrix that maps sets of time series to the set of state vectors, and \\(a\\) is a vector of scaling parameters. The multivariate setting would allow the analysis of each time series as an individual population.\nPosterior distributions of the model parameters are numerically derived using Markov chain Monte Carlo (MCMC) simulation in JAGS (Plummer, 20035; 20176).The MCMC simulations are based on 10,000 samples of 2 chains. Every other sample was retained to reduce auto-correlation, and the first 1000 samples of each chain were discarded as burn-in.\nFrom the model outputs, we are most interested in \\(r\\), the annual population growth rate, \\(Q\\), the process variance, and \\(\\text{T}_{final}\\), the estimated true log Annual Nesters for the final year of observed data. Posterior distributions of Annual Nesters for the final found years of data are used to estimate current abundance: \\[\n\\text{N}_{current} = \\frac{RI * (e^{\\text{T}_{final}})+(e^{\\text{T}_{final-1}})+(e^{\\text{T}_{final-2}})+(e^{\\text{T}_{final-3}})}{4}\n\\] where \\(RI\\) is the remigration interval for the population and \\(\\text{N}_{final}\\) is the median Annual Nesters estimated for the final year of data, \\(\\text{N}_{final-1}\\) is for the second to final year of data, and so on. This serves as a snapshot of Total Reproductive Females in the population, and assumes no mortaily of adults females during the \\(RI\\) period.\n\n\n\nPVA projections use a simulation approach with 10,000 runs for each species. Each projection is initialized in its starting year with a paired draw from the MCMC samples (joint posterior distribution) for (1) Annual Nesters (\\(N_0\\) = \\(\\text{N}_{final}\\)), (2) instantaneous population growth rate (\\(r\\)), (3) process error variance (\\(Q\\)) from the final data year of the historic trend analysis. For each subsequent year in the projection, a new \\(r\\) and \\(Q\\) are drawn as pairs from the MCMC samples to make the projections dynamic. Pulling paired draws from the MCMC samples reflects the inter-annual variation in the biology of the species, but also constrains parameter values to realistic combinations and therefore keeps the uncertainty in the projections reasonable.\nProjections can be evaluated against abundance thresholds. Here, the probability of falling below 50%, 25%, and 12.5% of current population size (\\(N_0\\)) is calculated at 5, 10, 25, 50, and 100-year time steps by summing the number of projections below the thresholds at the given time step and dividing by the total number of projections (10,000). Mean, median, and 95% confidence limits of number of years to reach the threshold are calculated for simulations that fall below a given population threshold, and the 100-year timestep simulation.\n\n\n\nIn principle, the incorporation of fisheries interactions into the PVA projections is simple: during the calculation of the number of females in the next time step (\\(\\text{N}_{j+1}\\)), the number of females in the current time step (\\(N_j\\)) is reduced by the incidental take in the current time step (\\(F_j\\)) and multiplied by the finite population growth rate (\\(\\lambda\\), = \\(e^r\\)). \\[\n\\text{N}_{j+1} = (N_j - F_j) * e^r\n\\] Therefore, the challenge comes from converting the incidental take of a given species (comprised of various lengths, ages, life stages, and sexes) to adult nester equivalents (ANE).\n1. Predicting anticipated take levels: The first goal is to generate the number and characteristics of the anticipated turtles that will be taken in each year. The number of turtles is referred to as the anticipated take level (ATL). Each year’s ATL was drawn from a Conway-Maxwell Poisson distribution (CMP), a two-parameter version of the Poisson distributions that includes a scale parameter \\(\\nu\\). \\(\\mu_{s,j}\\) is the mean of the CMP distribution, and \\(s\\) is one of three within-year segments which are summed to produce the total annual ATL (McCracken 20187). \\[\n\\text{ATL}_{j} \\; \\text~ \\sum^{3}_{s=1}{CMP(\\mu_{s,j},\\nu_{s,j})}\n\\] Each individual in the annual ATL receives (1) a length and fishery mortality from a bivariate normal distribution, (2) a back-calculated age with years until maturity based on a von Bertalanffy growth model, (3) juvenile survival rate, (4) sex, and (5) a remigration interval.\n2. Lengths and fishery mortality. Based on historic incidental take, a bivariate normal distribution is used to generate lengths in logarithmic space and assign fishery mortality in logit space. \\(\\theta_{L,j}\\) is a linear function of the annual incidental take (\\(F_j\\)) with intercept \\(a_0\\) and slope \\(a_1\\), and \\(\\sum\\) is the variance-covariance matrix with variances \\(\\sigma_L^2\\) and \\(\\sigma_D^2\\) for the log lengths (log(\\(L_k\\))) and logit assigned fishery mortality (logit(\\(D_k\\))) to have correlated draws. The parameters of the multivariate normal distribution (\\(a_0, a_1, \\sigma_L, \\sigma_D, \\rho_{L,D}\\)) are solved for in a Bayesian framework using STAN via RStan with 7,500 simulations per chain (5,000 burn-in, 2,500 retained) with 4 chains. \\[\n\\left( \\frac{log(L_k)}{logit(D_k)} \\right) \\;\\text~MVN\\left(\\frac{\\theta_{L,j}}{\\theta_D},\\;\\scriptstyle\\sum\\;\\right)\n\\] \\[\n\\theta_{L,j} = a_0 + a_1F_j\n\\]\n\\[\n\\scriptstyle\\sum = \\left[\\frac {\\sigma_L^2}{}{\\rho_{L,d}{}} \\right]\n\\] \\[\n\\Sigma = \\begin{pmatrix}\n\\mathrm{\\sigma_L^2} & \\mathrm{{\\rho_{L,D}}{\\sigma_{L}{\\sigma_{D}} \\\\\n\\mathrm{{\\rho_{L,D}}{\\sigma_L}{\\sigma_D}} & \\mathrm{\\sigma_D^2}\n\\end{pmatrix}\n\\]\n3. Age and stage. From all lengths of historically taken turtles, a von Bertalanffy growth model (VBGM) is used to calculate the expected length at age across the range of lengths for each species. Using the VBGM for each species, the age at maturity (\\(A_{mat}\\)) was assumed to correspond to a length of 97.5% of the maximum asymptotic maximum length (\\(L_\\infty\\)). Turtles with ages less than \\(A_{mat}\\) or lengths less than 97.5% of (\\(L_\\infty\\)) are considered immature. Years until maturity are calculated for all turtles as \\(Y_k = A_{mat} - {A_k}\\), where \\(A_k\\) is the age of the \\(k\\)th individual.\n4. Remigration interval, juvenile survival, and sex. In deterministic runs, each individual in the anticipated take is assigned the mean remigration interval (\\(RI\\)) and the mean juvenile survival (\\(\\phi\\)). In stochastic runs, each individual’s \\(RI\\) is drawn from a distribution (CMP for leatherbacks, truncated normal for loggerheads) and their juvenile survival is drawn from a normal distribution. The sex of each animal is drawn from a Bernoulli distribution for the probability of being female.\n5. ANE calculation. Adults in the anticipated take are given ANEs of 1. Juvenile ANEs are calculated by projecting the juvenile survival over the number of years to maturity, and dividing by remigration interval. The stochastic nature of sex ratio and fishery mortality are applied to adjust the individual ANE. The probability of an individual taken by a fishery dying is used with a Bernoulli distribution to simulate whether an individual dies. Therefore, the ANE of the \\(k\\)th individual is computed such that when the individual was a juvenile, female, and ended up dying, ANE was defined as the first equation below. However, when the individual was adult and either male or ends up alive, the ANE equals 0.\n\\[\nANE_k = \\frac{\\phi_J^{Y_k}}{RI}\n\\] \\[\nANE_{realized,k} = \\{{{\\frac{\\phi_J^{Y_k}}{RI}, Stage = J}\\atop{1 \\times Sex \\times Discard, Stage = A}}\n\\] 5. Historical ANE imputation. To account for the historical impact on the population growth rates, ANE is also calculated historically. Each turtle’s length is used to generate a likely age, stage, and years to maturity. Juveniles’ years to maturity are rounded to the nearest year, and adults are assumed to be nesting in the year of their fishery interaction. \\(Y_F\\) is the year incidental take occurred, \\(Y_k\\) is the yeras to maturity, RI is the remigration interval (rounded to 3 years). The survival probability between each nesting year has to be accounted for so that the initial ANE is adjusted, where \\(\\phi_J\\) and \\(\\phi_A\\) are juvenile and adult survival rates, \\(PF\\) is the proportion females, and \\(D\\) is the assigned fishery mortality. \\[\nY_{nest,k} = \\{{{Y_F+Y_k, y=1}\\atop{Y_{nest,k}-1+RI, y&gt;1}}\n\\] \\[\nANE_{k,j} = \\{{{{\\phi_J^{Nest_1}}\\times{PF} \\times D_k, y = 1}\\atop{{\\phi_A^{RI}, y&gt;1}}}\n\\] 6. Take calculation. After converting all individuals to ANEs, take (\\(F_j\\)) from the earlier equation is substituted out for the summation of the individual ANEs in a given year. To account to process variance \\(Q\\) from the trend analysis, the first equation below is modified to draw \\(N_{j+1}\\) from a normal distribution. The modified population growth model presented below is used as the basis for the future projections described above to produce future scenarios with take incorporated. \\[\n\\text{N}_{j+1} = (N_j - ANE_{realized,j}) * e^r\n\\] \\[\n\\text{N}_{j+1} = N((N_j - ANE_{realized,j}) * e^r, Q)\n\\]\n\n\n\nImputation:\n\nThe true number of nests per month is distributed normally, where the monthly means can be modeled with a discrete Fourier series with a fixed annual frequency. In other words, the number of peaks within a year is constant over the years. The variance around the means is assumed constant over the years.\nWe used an autoregressive model with a lag of one month (AR1 model) where the relationship between the numbers of nests in two months is modeled by the Fourier series. We assume this model sufficiently captures the cyclical nature of nesting throughout the year.\n\nTrend:\n\nThe proportion of total nests observed on a given beach is constant through time.\nThe time series of observed number of annual nesters are representative of the populations, as are the population growth rates observed for nesters. Note that index beaches are typically identified for long-term monitoring because they represent the population well.\nThe clutch frequency is constant through time.\nThe population growth rate is density-independent for each species (i.e., no carrying capacity or Allee effects in the timeframe considered).\nThe population growth rate is the same across the different beaches for each species (i.e., there is a single biological process resulting in a single trend).\nThe process and observation variances are estimable (with so few beaches, the prior has a lot of influence).\nThe index beaches in both Japan and Indonesia were observed with constant effort or were effort-corrected by the data collectors prior to being provided to PIFSC to form the time series used in these analyses.\nThe remigration interval is constant through time.\n\nProjections:\n\nThe population will face the same threats in the future as it did in the past. The PVA applies the population growth rate from the past, which was influenced by some particular magnitude of threats, to the future trajectory of the population. It does not account for the impacts of new or increasing threats, such as the loss of nesting habitat from climate change.\n\nTake model:\n\nThe anticipated take level (ATL) is constant through time and independent of fishery effort. This assumption was made by McCracken (2018) when generating the ATLs for the fishery.\nThe distribution of turtles’ sizes and post-interaction mortalities in the past is representative of what will be encountered in the future. We make this assumption when we use the fisheries observer data to inform characteristics of future turtles taken by the fishery, and do so because these are the best available data for the task.\nThe life history parameters are indicative of the populations of interest and are estimated accurately. Specifically, Amat(age at maturity) is 0.975 of Linf (asymptotic length; average length of mature females).\nTurtles will nest immediately once they reach maturity.\n\n\n\n\nWe made a number of decisions in the analyses that were inherently conservative for the turtle species in question (i.e., likely inflated the mortality relative to the true). We highlight those here to provide context for interpretation:\n\nWe applied the entire anticipated take for the fishery in future years to the index beaches for which we had data; however, those index beaches represent only 52% and 75% of the nesting populations for loggerheads and leatherbacks, respectively. Assessing the impact of the entire take on the index beach populations rather than the full populations is conservative for the species.\nThe Bayesian trend analysis accounts for the parameter uncertainty by incorporating estimated uncertainty of demographic parameters. Consequently, we found large uncertainty around the estimated population growth rate (r), which resulted in greater or lesser chance of recovering than what was found from a frequentist approach. This finding provides an accurate assessment of the projected population given what we know about the population.\nThe anticipated take level is biased high (the CMP distribution tends to draw ATLs that are higher than the take levels observed in previous years).\nIn calculating Adult Nester Equivalents (ANEs) in our historical analysis of fishery impacts (see Historical ANE Imputation), we assume that nesters would have repeatedly returned to nest at a constant remigration interval with an annual probability of survival equal to 0.89 for leatherbacks and 0.90 for loggerheads. However, for loggerheads, Japanese colleagues have indicated that nesters have a relatively low probability of being observed nesting in future years after their initial sighting (approximately 0.30), suggesting potentially high threats in the marine environment. If this is true, then the ANE values in our historical analysis (see Historical ANE Imputation) are inflated compared to the true ANE values (i.e., we added back loggerhead nesters to the population when in reality they had a low chance of surviving to the next nesting season)."
  },
  {
    "objectID": "about.html#footnotes",
    "href": "about.html#footnotes",
    "title": "Introduction",
    "section": "Footnotes",
    "text": "Footnotes\n\n\nBoyd, C., D. P. DeMaster, R. S. Waples, E. J. Ward, and B. L. Taylor. 2017. Consistent extinction risk assessment under the US Endangered Species Act. Conservation Letters 10:328-336.↩︎\nHolmes EE, Sabo JL, Viscido SV, Fagan WF. 2007. A statistical approach to quasi‐extinction forecasting. Ecology Letters. 10(12):1182-1198.↩︎\nBoyd, C., D. P. DeMaster, R. S. Waples, E. J. Ward, and B. L. Taylor. 2017. Consistent extinction risk assessment under the US Endangered Species Act. Conservation Letters 10:328-336.↩︎\nHinrichsen R, Holmes EE. 2009. Using multivariate state-space models to study spatial structure and dynamics. Spatial Ecology.145-166.↩︎\nPlummer M. 2003. Jags: A program for analysis of bayesian graphical models using Gibbs sampling. Proceedings of the 3rd international workshop on distributed statistical computing. Vienna, Austria.↩︎\nPlummer M. 2017. Jags version 4.3.0 user manual. http://mcmc-jagssourceforgenet/.↩︎\nMcCracken ML. 2018. Hawaii permitted shallow-set longline fishery estimated anticipated take level for Endangered Species Act listed species. In: NOAA Fisheries Pacific Islands Science Center, editor. Honolulu, HI USA↩︎"
  },
  {
    "objectID": "imputation.html",
    "href": "imputation.html",
    "title": "imputation",
    "section": "",
    "text": "Overview\nThis page of code explains and demonstrates how to get started with your population modelling. You will need to start by installing or loading numerous R packages,and making sure that your data are"
  },
  {
    "objectID": "content/intro.html",
    "href": "content/intro.html",
    "title": "Introduction",
    "section": "",
    "text": "Population viability analysis (PVA) is a conservation tool used to help managers assess extinction risk and guide policy decisions. PVA is mathematical model that uses demographic and life history data to predict the long-term trend of a population, and its sensitivity to changes in life history parameters or environmental stochasticity. This allows users to assess the long-term impact of current threats, such as fisheries bycatch, or conservation actions, such as nesting beach protections.\n\n\nPVA combines two primary components:\n\nRetrospective fitting: Estimating historical trends and current nesting female abundance based on empirical data.\nFuture projections: A simulation approach to evaluate projections against abundance thresholds (here: the probability of falling below either 50%, 25%, or 12.5% of the current population size).\n\n\n\n\nThis assessment was performed in a Bayesian framework with four main components: nesting data imputation, nesting trend analysis, population viability analysis, and incorporation of fishery take into the PVA (the “take model” component). The Bayesian framework is a statistical method for combining a prior probability (existing knowledge) with new data (likelihood) to produce a revised posterior probability. Instead of using just a single estimate for a PVA, it provides a posterior distribution that quantifies the uncertainty of parameters.\n\n\nMonthly nest count data from different nesting beaches were available for these analyses. However, some months were missing from the leatherback dataset. Therefore, the dataset represents observed nests, but those counts do not fully capture the true number of nests, as not all nests in the population were observed. To fill in the gaps, we used a Bayesian hierarchical model to impute the missing monthly nest counts and produce a time series of annual nest counts.\nThe imputation model was autoregressive with a lag of one month, and the relationship between the numbers of nests in two months was modeled by a Fourier series. This allows the model to capture the periodicity of nesting, e.g. Jamursba-Medi has one single summer peak in nesting, and Wemon has both summer and winter peaks.\n\n\n\nPopulation growth rates are estimated using a stochastic density-independent exponential growth model applied to nest count data (Boyd et al. 20171, Holmes et al. (2007)2. This model is common for long-lived, slow-growing, late-maturing species such as sea turtles, whose populations have been depleted to relatively low levels.\nBy dividing nest counts by clutch frequency, we calculated a time series of annual nesters. Summing annual nesters across one remigration interval provides a snapshot of the total nesters in the population.\nWe solved for population growth rate by subtracting the natural log of annual nesters in one year by the natural log of annual nesters in the previous year. This estimated population growth rate would be better interpreted as long-term annual trends, as we use nests as a proxy for nesters but cannot assume that their trend applies to adult males, or immature turtles of both sexes.\nFollowing Boyd et al. (2017), we construct a Bayesian state-space model (BSSM) from the natural log version of the exponential population growth equation. The BSSM allows for estimation of environmental and demographic variability and imperfect data collection and provides posterior distributions, which are useful for conveying uncertainty in management applications.\nThere are two major components of the BSSM: the process model describing the true number of nesting females each year, and the observation model relating the observed count data to the true number of nesting females. Three parameters are estimated: \\(r\\), the instantaneous population growth rate, \\(Q\\), the process error variance, and \\(R\\), the observation error variance. The model also provides a predicted count with a probability distribution for each year of observed data. The predicted value for the final year of observed data is then used as a starting point for future projections.\nWe define the model to only have one population with multiple time series of observations (i.e., multiple beaches).This structure best represents the known population dynamics of genetic similarity and exchange of individuals across the studied beaches. However, the basic model can be expanded to accommodate multiple state vectors, representing several populations and multiple time series (Hinrichsen and Holmes 20093).\nPosterior distributions of the model parameters are numerically derived using Markov chain Monte Carlo (MCMC) simulation in JAGS (Plummer, 20034; 20175).The MCMC simulations are based on 10,000 samples of 2 chains. Every other sample was retained to reduce auto-correlation, and the first 1000 samples of each chain were discarded as burn-in.\nFrom the model outputs, we are most interested in \\(r\\), the annual population growth rate, \\(Q\\), the process variance, and \\(\\text{T}_{final}\\), the estimated true log Annual Nesters for the final year of observed data. Posterior distributions of Annual Nesters for the final found years of data are used to estimate current abundance.\n\n\n\nPVA projections use a simulation approach with 10,000 runs for each species. Each projection is initialized in its starting year with a paired draw from the MCMC samples (joint posterior distribution) for (1) Annual Nesters (\\(N_0\\) = \\(\\text{N}_{final}\\)), (2) instantaneous population growth rate (\\(r\\)), (3) process error variance (\\(Q\\)) from the final data year of the historic trend analysis. For each subsequent year in the projection, a new \\(r\\) and \\(Q\\) are drawn as pairs from the MCMC samples to make the projections dynamic. Pulling paired draws from the MCMC samples reflects the inter-annual variation in the biology of the species, but also constrains parameter values to realistic combinations and therefore keeps the uncertainty in the projections reasonable.\nProjections can be evaluated against abundance thresholds. Here, the probability of falling below 50%, 25%, and 12.5% of current population size (\\(N_0\\)) is calculated at 5, 10, 25, 50, and 100-year time steps by summing the number of projections below the thresholds at the given time step and dividing by the total number of projections (10,000). Mean, median, and 95% confidence limits of number of years to reach the threshold are calculated for simulations that fall below a given population threshold, and the 100-year timestep simulation.\n\n\n\nIn principle, the incorporation of fisheries interactions into the PVA projections is simple: during the calculation of the number of females in the next time step (\\(\\text{N}_{j+1}\\)), the number of females in the current time step (\\(N_j\\)) is reduced by the incidental take in the current time step (\\(F_j\\)) and multiplied by the finite population growth rate (\\(\\lambda\\), = \\(e^r\\)). \\[\n\\text{N}_{j+1} = (N_j - F_j) * e^r\n\\] Therefore, the challenge comes from converting the incidental take of a given species (comprised of various lengths, ages, life stages, and sexes) to adult nester equivalents (ANE).\n1. Predicting anticipated take levels: The first goal is to generate the number and characteristics of the anticipated turtles that will be taken in each year. Each year’s anticipated take level was drawn from a Conway-Maxwell Poisson distribution (CMP). Each “anticipated take” individual receives (1) a length and fishery mortality from a bivariate normal distribution, (2) a back-calculated age with years until maturity based on a von Bertalanffy growth model, (3) juvenile survival rate, (4) sex, and (5) a remigration interval.\n2. Lengths and fishery mortality. Based on historic incidental take, a bivariate normal distribution is used to generate lengths in logarithmic space and assign fishery mortality in logit space. The parameters of the multivariate normal distribution are solved for in a Bayesian framework using STAN via RStan with 7,500 simulations per chain (5,000 burn-in, 2,500 retained) with 4 chains.\n3. Age and stage. From all lengths of historically taken turtles, a von Bertalanffy growth model (VBGM) is used to calculate the expected length at age across the range of lengths for each species. Using the VBGM for each species, the age at maturity (\\(A_{mat}\\)) was assumed to correspond to a length of 97.5% of the maximum asymptotic maximum length (\\(L_\\infty\\)). Turtles with ages less than \\(A_{mat}\\) or lengths less than 97.5% of (\\(L_\\infty\\)) are considered immature. Years until maturity are calculated for all turtles.\n4. Remigration interval, juvenile survival, and sex. In deterministic runs, each individual in the anticipated take is assigned the mean remigration interval (\\(RI\\)) and the mean juvenile survival (\\(\\phi\\)). In stochastic runs, each individual’s \\(RI\\) is drawn from a distribution (CMP for leatherbacks, truncated normal for loggerheads) and their juvenile survival is drawn from a normal distribution. The sex of each animal is drawn from a Bernoulli distribution for the probability of being female.\n5. ANE calculation. Adults in the anticipated take are given ANEs of 1. Juvenile ANEs are calculated by projecting the juvenile survival over the number of years to maturity, and dividing by remigration interval. The stochastic nature of sex ratio and fishery mortality are applied to adjust the individual ANE. The probability of an individual taken by a fishery dying is used with a Bernoulli distribution to simulate whether an individual dies.\n5. Historical ANE imputation. To account for the historical impact on the population growth rates, ANE is also calculated historically. Each turtle’s length is used to generate a likely age, stage, and years to maturity. Juveniles’ years to maturity are rounded to the nearest year, and adults are assumed to be nesting in the year of their fishery interaction.\n6. Take calculation. After converting all individuals to ANEs, “take” is used as the summation of the individual ANEs in a given year. To account to process variance \\(Q\\) from the trend analysis, the first equation below is modified to draw the number of nesters in the following year from a normal distribution. The modified population growth model is used as the basis for the future projections described above to produce future scenarios with take incorporated.\n\n\n\nWe made a number of decisions in the analyses that were inherently conservative for the turtle species in question (i.e., likely inflated the mortality relative to the true). We highlight those here to provide context for interpretation:\n\nWe applied the entire anticipated take for the fishery in future years to the index beaches for which we had data; however, those index beaches represent only 52% and 75% of the nesting populations for loggerheads and leatherbacks, respectively. Assessing the impact of the entire take on the index beach populations rather than the full populations is conservative for the species.\nThe Bayesian trend analysis accounts for the parameter uncertainty by incorporating estimated uncertainty of demographic parameters. Consequently, we found large uncertainty around the estimated population growth rate (r), which resulted in greater or lesser chance of recovering than what was found from a frequentist approach. This finding provides an accurate assessment of the projected population given what we know about the population.\nThe anticipated take level is biased high (the CMP distribution tends to draw ATLs that are higher than the take levels observed in previous years).\nIn calculating Adult Nester Equivalents (ANEs) in our historical analysis of fishery impacts (see Historical ANE Imputation), we assume that nesters would have repeatedly returned to nest at a constant remigration interval with an annual probability of survival equal to 0.89 for leatherbacks and 0.90 for loggerheads. However, for loggerheads, Japanese colleagues have indicated that nesters have a relatively low probability of being observed nesting in future years after their initial sighting (approximately 0.30), suggesting potentially high threats in the marine environment. If this is true, then the ANE values in our historical analysis (see Historical ANE Imputation) are inflated compared to the true ANE values (i.e., we added back loggerhead nesters to the population when in reality they had a low chance of surviving to the next nesting season).",
    "crumbs": [
      "Methods Introduction"
    ]
  },
  {
    "objectID": "content/intro.html#conceptual-framework",
    "href": "content/intro.html#conceptual-framework",
    "title": "Introduction",
    "section": "",
    "text": "PVA combines two primary components:\n\nRetrospective fitting: Estimating historical trends and current nesting female abundance based on empirical data.\nFuture projections: A simulation approach to evaluate projections against abundance thresholds (here: the probability of falling below either 50%, 25%, or 12.5% of the current population size).",
    "crumbs": [
      "Methods Introduction"
    ]
  },
  {
    "objectID": "content/intro.html#methods-outline",
    "href": "content/intro.html#methods-outline",
    "title": "Introduction",
    "section": "",
    "text": "This assessment was performed in a Bayesian framework with four main components: nesting data imputation, nesting trend analysis, population viability analysis, and incorporation of fishery take into the PVA (the “take model” component). The Bayesian framework is a statistical method for combining a prior probability (existing knowledge) with new data (likelihood) to produce a revised posterior probability. Instead of using just a single estimate for a PVA, it provides a posterior distribution that quantifies the uncertainty of parameters.\n\n\nMonthly nest count data from different nesting beaches were available for these analyses. However, some months were missing from the leatherback dataset. Therefore, the dataset represents observed nests, but those counts do not fully capture the true number of nests, as not all nests in the population were observed. To fill in the gaps, we used a Bayesian hierarchical model to impute the missing monthly nest counts and produce a time series of annual nest counts.\nThe imputation model was autoregressive with a lag of one month, and the relationship between the numbers of nests in two months was modeled by a Fourier series. This allows the model to capture the periodicity of nesting, e.g. Jamursba-Medi has one single summer peak in nesting, and Wemon has both summer and winter peaks.\n\n\n\nPopulation growth rates are estimated using a stochastic density-independent exponential growth model applied to nest count data (Boyd et al. 20171, Holmes et al. (2007)2. This model is common for long-lived, slow-growing, late-maturing species such as sea turtles, whose populations have been depleted to relatively low levels.\nBy dividing nest counts by clutch frequency, we calculated a time series of annual nesters. Summing annual nesters across one remigration interval provides a snapshot of the total nesters in the population.\nWe solved for population growth rate by subtracting the natural log of annual nesters in one year by the natural log of annual nesters in the previous year. This estimated population growth rate would be better interpreted as long-term annual trends, as we use nests as a proxy for nesters but cannot assume that their trend applies to adult males, or immature turtles of both sexes.\nFollowing Boyd et al. (2017), we construct a Bayesian state-space model (BSSM) from the natural log version of the exponential population growth equation. The BSSM allows for estimation of environmental and demographic variability and imperfect data collection and provides posterior distributions, which are useful for conveying uncertainty in management applications.\nThere are two major components of the BSSM: the process model describing the true number of nesting females each year, and the observation model relating the observed count data to the true number of nesting females. Three parameters are estimated: \\(r\\), the instantaneous population growth rate, \\(Q\\), the process error variance, and \\(R\\), the observation error variance. The model also provides a predicted count with a probability distribution for each year of observed data. The predicted value for the final year of observed data is then used as a starting point for future projections.\nWe define the model to only have one population with multiple time series of observations (i.e., multiple beaches).This structure best represents the known population dynamics of genetic similarity and exchange of individuals across the studied beaches. However, the basic model can be expanded to accommodate multiple state vectors, representing several populations and multiple time series (Hinrichsen and Holmes 20093).\nPosterior distributions of the model parameters are numerically derived using Markov chain Monte Carlo (MCMC) simulation in JAGS (Plummer, 20034; 20175).The MCMC simulations are based on 10,000 samples of 2 chains. Every other sample was retained to reduce auto-correlation, and the first 1000 samples of each chain were discarded as burn-in.\nFrom the model outputs, we are most interested in \\(r\\), the annual population growth rate, \\(Q\\), the process variance, and \\(\\text{T}_{final}\\), the estimated true log Annual Nesters for the final year of observed data. Posterior distributions of Annual Nesters for the final found years of data are used to estimate current abundance.\n\n\n\nPVA projections use a simulation approach with 10,000 runs for each species. Each projection is initialized in its starting year with a paired draw from the MCMC samples (joint posterior distribution) for (1) Annual Nesters (\\(N_0\\) = \\(\\text{N}_{final}\\)), (2) instantaneous population growth rate (\\(r\\)), (3) process error variance (\\(Q\\)) from the final data year of the historic trend analysis. For each subsequent year in the projection, a new \\(r\\) and \\(Q\\) are drawn as pairs from the MCMC samples to make the projections dynamic. Pulling paired draws from the MCMC samples reflects the inter-annual variation in the biology of the species, but also constrains parameter values to realistic combinations and therefore keeps the uncertainty in the projections reasonable.\nProjections can be evaluated against abundance thresholds. Here, the probability of falling below 50%, 25%, and 12.5% of current population size (\\(N_0\\)) is calculated at 5, 10, 25, 50, and 100-year time steps by summing the number of projections below the thresholds at the given time step and dividing by the total number of projections (10,000). Mean, median, and 95% confidence limits of number of years to reach the threshold are calculated for simulations that fall below a given population threshold, and the 100-year timestep simulation.\n\n\n\nIn principle, the incorporation of fisheries interactions into the PVA projections is simple: during the calculation of the number of females in the next time step (\\(\\text{N}_{j+1}\\)), the number of females in the current time step (\\(N_j\\)) is reduced by the incidental take in the current time step (\\(F_j\\)) and multiplied by the finite population growth rate (\\(\\lambda\\), = \\(e^r\\)). \\[\n\\text{N}_{j+1} = (N_j - F_j) * e^r\n\\] Therefore, the challenge comes from converting the incidental take of a given species (comprised of various lengths, ages, life stages, and sexes) to adult nester equivalents (ANE).\n1. Predicting anticipated take levels: The first goal is to generate the number and characteristics of the anticipated turtles that will be taken in each year. Each year’s anticipated take level was drawn from a Conway-Maxwell Poisson distribution (CMP). Each “anticipated take” individual receives (1) a length and fishery mortality from a bivariate normal distribution, (2) a back-calculated age with years until maturity based on a von Bertalanffy growth model, (3) juvenile survival rate, (4) sex, and (5) a remigration interval.\n2. Lengths and fishery mortality. Based on historic incidental take, a bivariate normal distribution is used to generate lengths in logarithmic space and assign fishery mortality in logit space. The parameters of the multivariate normal distribution are solved for in a Bayesian framework using STAN via RStan with 7,500 simulations per chain (5,000 burn-in, 2,500 retained) with 4 chains.\n3. Age and stage. From all lengths of historically taken turtles, a von Bertalanffy growth model (VBGM) is used to calculate the expected length at age across the range of lengths for each species. Using the VBGM for each species, the age at maturity (\\(A_{mat}\\)) was assumed to correspond to a length of 97.5% of the maximum asymptotic maximum length (\\(L_\\infty\\)). Turtles with ages less than \\(A_{mat}\\) or lengths less than 97.5% of (\\(L_\\infty\\)) are considered immature. Years until maturity are calculated for all turtles.\n4. Remigration interval, juvenile survival, and sex. In deterministic runs, each individual in the anticipated take is assigned the mean remigration interval (\\(RI\\)) and the mean juvenile survival (\\(\\phi\\)). In stochastic runs, each individual’s \\(RI\\) is drawn from a distribution (CMP for leatherbacks, truncated normal for loggerheads) and their juvenile survival is drawn from a normal distribution. The sex of each animal is drawn from a Bernoulli distribution for the probability of being female.\n5. ANE calculation. Adults in the anticipated take are given ANEs of 1. Juvenile ANEs are calculated by projecting the juvenile survival over the number of years to maturity, and dividing by remigration interval. The stochastic nature of sex ratio and fishery mortality are applied to adjust the individual ANE. The probability of an individual taken by a fishery dying is used with a Bernoulli distribution to simulate whether an individual dies.\n5. Historical ANE imputation. To account for the historical impact on the population growth rates, ANE is also calculated historically. Each turtle’s length is used to generate a likely age, stage, and years to maturity. Juveniles’ years to maturity are rounded to the nearest year, and adults are assumed to be nesting in the year of their fishery interaction.\n6. Take calculation. After converting all individuals to ANEs, “take” is used as the summation of the individual ANEs in a given year. To account to process variance \\(Q\\) from the trend analysis, the first equation below is modified to draw the number of nesters in the following year from a normal distribution. The modified population growth model is used as the basis for the future projections described above to produce future scenarios with take incorporated.\n\n\n\nWe made a number of decisions in the analyses that were inherently conservative for the turtle species in question (i.e., likely inflated the mortality relative to the true). We highlight those here to provide context for interpretation:\n\nWe applied the entire anticipated take for the fishery in future years to the index beaches for which we had data; however, those index beaches represent only 52% and 75% of the nesting populations for loggerheads and leatherbacks, respectively. Assessing the impact of the entire take on the index beach populations rather than the full populations is conservative for the species.\nThe Bayesian trend analysis accounts for the parameter uncertainty by incorporating estimated uncertainty of demographic parameters. Consequently, we found large uncertainty around the estimated population growth rate (r), which resulted in greater or lesser chance of recovering than what was found from a frequentist approach. This finding provides an accurate assessment of the projected population given what we know about the population.\nThe anticipated take level is biased high (the CMP distribution tends to draw ATLs that are higher than the take levels observed in previous years).\nIn calculating Adult Nester Equivalents (ANEs) in our historical analysis of fishery impacts (see Historical ANE Imputation), we assume that nesters would have repeatedly returned to nest at a constant remigration interval with an annual probability of survival equal to 0.89 for leatherbacks and 0.90 for loggerheads. However, for loggerheads, Japanese colleagues have indicated that nesters have a relatively low probability of being observed nesting in future years after their initial sighting (approximately 0.30), suggesting potentially high threats in the marine environment. If this is true, then the ANE values in our historical analysis (see Historical ANE Imputation) are inflated compared to the true ANE values (i.e., we added back loggerhead nesters to the population when in reality they had a low chance of surviving to the next nesting season).",
    "crumbs": [
      "Methods Introduction"
    ]
  },
  {
    "objectID": "content/intro.html#footnotes",
    "href": "content/intro.html#footnotes",
    "title": "Introduction",
    "section": "Footnotes",
    "text": "Footnotes\n\n\nBoyd, C., D. P. DeMaster, R. S. Waples, E. J. Ward, and B. L. Taylor. 2017. Consistent extinction risk assessment under the US Endangered Species Act. Conservation Letters 10:328-336.↩︎\nHolmes EE, Sabo JL, Viscido SV, Fagan WF. 2007. A statistical approach to quasi‐extinction forecasting. Ecology Letters. 10(12):1182-1198.↩︎\nHinrichsen R, Holmes EE. 2009. Using multivariate state-space models to study spatial structure and dynamics. Spatial Ecology.145-166.↩︎\nPlummer M. 2003. Jags: A program for analysis of bayesian graphical models using Gibbs sampling. Proceedings of the 3rd international workshop on distributed statistical computing. Vienna, Austria.↩︎\nPlummer M. 2017. Jags version 4.3.0 user manual. http://mcmc-jagssourceforgenet/.↩︎",
    "crumbs": [
      "Methods Introduction"
    ]
  },
  {
    "objectID": "content/s1_imputation/imputation.html",
    "href": "content/s1_imputation/imputation.html",
    "title": "Nest count imputation",
    "section": "",
    "text": "Overview\nThis page of code explains and demonstrates how to get started with your population modeling by processing your raw data into imputed nest counts (no missing data). On this page, you can read in your data to process raw observations of nests, implement JAGS, and view a summary of the JAGS model.\n\n\nImputing monthly nest counts\nSome months were missing from the leatherback dataset, so we used a Bayesian hierarchical model to impute the missing monthly nest counts. This assumes that the dataset contains observed nests, but these values do not fully capture the true number of nests, as not all nests were observed. The relationship between the monthly nest counts recorded on the beach in natural log space (\\(\\text{y}_{t,m}\\)) and the natural log of the true number of nests \\(\\text{X}_{t,m}\\) will be explained below:\nWe model the natural logarithm (natural log) of monthly counts at a nesting beach as an auto-regressive model. \\[\n\\text{u}_{t,m} = \\text{s}_{t,m} + \\text{X}_{t-1,m-1}\n\\] \\(\\text{u}_{t,m}\\) is the mean of the natural log of the true number of nests at time \\(t\\) of month \\(m\\), \\(\\text{s}_{t,m}\\) is the “slope” parameter at time \\(t\\), which is defined by month (\\(m\\) = 1 to 12). \\(\\text{X}_{t-1,m}\\) is the natural log of the true nest count at time \\(t - 1\\). While month index \\(m\\) corresponds to sequential months in each nesting season (e.g. months 1 through 12), the time index starts at the first month of the time series and increases monthly throughout all years in the time series.\nThe state-space \\(\\text{X}_{t,m}\\) is modeled with a normal distribution with the mean \\(\\text{u}_{t,m}\\) and standard deviation \\(\\sigma_X\\), which was assumed to be constant over time. \\[\n\\text{X}_{t,m} \\text~N(\\text{u}_{t,m},\\sigma_X)\n\\] Observations \\(\\text{y}_{t,m}\\) are modeled with another normal distribution with standard deviation \\(\\sigma_y\\). also assumed to be constant over time. \\[\n\\text{y}_{t,m} \\text~N(\\text{X}_{t,m},\\sigma_y)\n\\] The slope \\(\\text{s}_{t,m}\\) parameters are modeled with the discrete Fourier series y acknowledging the periodicity of nesting. For Jamursba Medi, a 12-month period captures the single summer peak in nesting, whereas the summer and winter peaks of nesting in Wermon are captured by a 6-month period. \\[\n\\text{s}_{t,m} = \\beta_1 * cos(2\\pi(\\frac{m}{period})) + \\beta_2 * sin(2\\pi(\\frac{m}{period})\n\\] The two coefficients (\\(\\beta_1\\) and \\(\\beta_2\\)) were estimated from the data. The annual number of nests for each season (April through March; \\(X_T\\)) are computed as the sum of estimated true monthly log numbers of nests (\\(\\text{X}_{t,m}\\)), derived from imputed log observed nest counts (\\(\\text{y}_{t,m}\\)). \\[\nX_T = \\sum{exp(\\text{X}_{.,m}})\n\\] \\(\\text{X}_{.,m}\\) indicates all \\(t\\) values from \\(m\\) = 1 to \\(m\\) = 12.\nPrior distributions for the parameters are not flat but with large uncertainties in the natural log space. Normal distributions with mean = 0 and variance = 1 are used for the two parameters for the Fourier discrete function (\\(\\beta_1, \\beta_2\\)), whereas gamma distributions with the shape parameter = 2 and rate parameter = 0.5 are used for the standard deviation parameters for the process (\\(\\sigma_X\\)) and observation (\\(\\sigma_y\\)) models.\n\n\nLoad libraries, functions, and nest count data\n\nlibrary(here)\nlibrary(dplyr)\nlibrary(jagsUI)\n\nsource(here::here(\"_R_code/task_1_nest_imputation/functions.R\"))\n\nmain.folder &lt;- here(\"_R_code\",\"task_1_nest_imputation\")\ndata.path &lt;- main.folder\nfile.path &lt;- main.folder\n\n            period.JM &lt;- 12\n            period.W &lt;- 6\n            maxN &lt;- 10000\n\n            all.years &lt;- 2001:2017\n            idx &lt;- 1:length(all.years)\n\n            year.begin.JM &lt;- 2001\n            year.end &lt;- 2017\n            data.jags.JM &lt;- data.extract(location = \"JM\", \n                                         year.begin = year.begin.JM, \n                                         year.end = year.end,\n                                         file.path = data.path)\n            \n            JM.keep &lt;- 2001:2017\n            idx.JM &lt;- idx[all.years %in% JM.keep]\n            n.keep.JM &lt;- length(idx.JM)\n            dt.JM &lt;- idx.JM[2:length(idx.JM)] - idx.JM[1:(length(idx.JM)-1)]\n\n            year.begin.W &lt;- 2006\n            data.jags.W &lt;- data.extract(location = \"W\", \n                                        year.begin = year.begin.W, \n                                        year.end = year.end,\n                                         file.path = data.path)\n            W.keep &lt;- c(2006, 2007, 2008, 2009, 2010, 2011, 2012, 2016, 2017)\n            idx.W &lt;- idx[all.years %in% W.keep]\n            n.keep.W &lt;- length(idx.W)\n            dt.W &lt;- idx.W[2:length(idx.W)] - idx.W[1:(length(idx.W)-1)]\n\n\nModeling assumptions\nThe true number of nests per month is distributed normally, where the monthly means can be modeled with a discrete Fourier series with a fixed annual frequency. In other words, the number of peaks within a year is constant over the years. The variance around the means is assumed constant over the years.\nWe used an autoregressive model with a lag of one month (AR1 model) where the relationship between the numbers of nests in two months is modeled by the Fourier series. We assume this model sufficiently captures the cyclical nature of nesting throughout the year.",
    "crumbs": [
      "Nest imputation"
    ]
  },
  {
    "objectID": "content/s1_imputation/imputation.html#load-packages-and-define-working-directory",
    "href": "content/s1_imputation/imputation.html#load-packages-and-define-working-directory",
    "title": "Nest count imputation",
    "section": "Load packages and define working directory",
    "text": "Load packages and define working directory\n\nlibrary(dplyr)\nlibrary(jagsUI)",
    "crumbs": [
      "Nest imputation"
    ]
  },
  {
    "objectID": "content/s1_imputation/imputation.html#load-packages-and-update-working-directory",
    "href": "content/s1_imputation/imputation.html#load-packages-and-update-working-directory",
    "title": "Nest count imputation",
    "section": "Load packages and update working directory",
    "text": "Load packages and update working directory\n\nlibrary(here)\nlibrary(dplyr)\nlibrary(jagsUI)\n\nlocalwd &lt;- here(\"_R_code\",\"task_1_nest_imputation\")\ndata.extract &lt;- file.path(localwd, \"data.extract.R\")",
    "crumbs": [
      "Nest imputation"
    ]
  },
  {
    "objectID": "content/s1_imputation/imputation.html#how-to-extract-data",
    "href": "content/s1_imputation/imputation.html#how-to-extract-data",
    "title": "Nest count imputation",
    "section": "How to extract data",
    "text": "How to extract data",
    "crumbs": [
      "Nest imputation"
    ]
  },
  {
    "objectID": "content/s1_imputation/imputation.html#load-helper-function-to-extract-data",
    "href": "content/s1_imputation/imputation.html#load-helper-function-to-extract-data",
    "title": "Nest count imputation",
    "section": "Load helper function to extract data",
    "text": "Load helper function to extract data",
    "crumbs": [
      "Nest imputation"
    ]
  },
  {
    "objectID": "content/s1_imputation/imputation.html#load-packages-update-working-directory-and-load-helper-function",
    "href": "content/s1_imputation/imputation.html#load-packages-update-working-directory-and-load-helper-function",
    "title": "Nest count imputation",
    "section": "Load packages, update working directory, and load helper function",
    "text": "Load packages, update working directory, and load helper function\n\nlibrary(here)\nlibrary(dplyr)\nlibrary(jagsUI)\n\nlocalwd &lt;- here(\"_R_code\",\"task_1_nest_imputation\")\ndata.extract &lt;- file.path(localwd, \"data.extract.R\")",
    "crumbs": [
      "Nest imputation"
    ]
  },
  {
    "objectID": "content/s2_retrospective/retro.html",
    "href": "content/s2_retrospective/retro.html",
    "title": "Retrospective trend analysis",
    "section": "",
    "text": "Population growth rates are estimated using a stochastic density-independent exponential growth model applied to nest count data (Boyd et al. 20171, Holmes et al. (2007)2. \\[\nN_j = \\text{N}_{j-1}e^r\n\\] \\(N_j\\) is the number of Annual Nesters in the year \\(j\\), \\(r\\) is the instantaneous population growth rate (i.e. long-term annual trend), and \\(e^r\\) = \\(\\lambda\\) (i.e., “lambda”, the finite rate of increase for the population).\nThis model is common for long-lived, slow-growing, late-maturing species such as sea turtles, whose populations have been depleted to relatively low levels. The assumption of density-independence could be evaluated in future by running a density-dependent model (e.g. Gompertz model), which would allow the population to reach carrying capacity at some point in the future.\nThe data inputs to the model were the time series of Annual Nesters, or the number of females arriving on a beach to nest each year. These were derived from observed nest counts, by dividing each nest count by mean clutch frequency (i.e. the mean number of clutches per nesting female in a nesting season). This static conversion does not affect the estimation process, but puts results into management-relevant terms. The number of Annual Nesters summed across one remigration interval (i.e. the number of years between nesting events of the same female) yields a snapshot of the Total Nesters in the population.\nThe trend estimates here are better interpreted as long-term annual trends in the number of nesters, rather than the true population growth rates. This is because the model relies exclusively on nest count data, nesters only represent a small portion of the total population that includes males and immature turtles of both sexes, and assuming true population growth rates would require the assumption of a stable age distribution, for which no data exists.\nThe exponential growth rate was transformed into natural log space and solved for the population growth rate: \\[\nln(N_j) = ln(\\text{N}_{j-1}) + r\n\\] \\[\nr = ln(N_j) - ln(\\text{N}_{j-1})\n\\] Following Boyd et al. (2017)3, we construct a Bayesian state-space model (BSSM) from the natural log version of the exponential population growth equation. The BSSM allows for estimation of process variation (i.e., environmental and demographic variability) and observation uncertainty (i.e., imperfect data collection) and provides posterior distributions (i.e., parameter estimates with probability distributions) which are useful for conveying uncertainty in management applications.\nThere are two major components of the BSSM: the process model describing the true number of nesting females each year, and the observation model relating the observed count data to the true number of nesting females. Three parameters are estimated: \\(r\\), the instantaneous population growth rate, \\(Q\\), the process error variance, and \\(R\\), the observation error variance. The model also provides a predicted count with a probability distribution for each year of observed data. The predicted value for the final year of observed data is then used as a starting point for future projections.\n\\[\n\\text{Process equation:}\\quad {T_j = \\text{T}_{j-1} + r + p_j} \\quad \\text{where}\\; p_j \\,\\text ~\\, N(0,Q)\n\\] Where \\(T_j\\) is the natural log of the true number of annual nesters in year \\(j\\), \\(r\\) is the instantaneous population growth rate, \\(p_j\\) is the process error at year \\(j\\), and \\(Q\\) is the state process (time invariant). The true state variable, \\(T_j\\) is not directly measured for the MP loggerheads nor WP leatherbacks. Instead, nest counts are observed on multiple beaches for each population, and the resulting time series come with various forms of observation uncertainty (i.e., missed nests or falsely identified nests). The relationship between the observed data and the corresponding number of true Annual Nesters is defined by a second equation: \\[\n\\text{Observation equation:}\\quad {B_j = T_j + o_j} \\quad \\text{where}\\; o_j \\,\\text ~\\, N(0,R)\n\\] where \\(B_j\\) is the natural log of the observed nesters, \\(o_j\\) is the observation error at year \\(j\\), and \\(R\\) is the variance of the observation process (time invariant).\nFor both NP loggerheads and WP leatherbacks, we define the model to only have one population with multiple time series of observations (i.e., multiple beaches).This structure best represents the known population dynamics of genetic similarity and exchange of individuals across the studied beaches.\nHowever, the basic model can be expanded to accommodate multiple state vectors, representing several populations and multiple time series (Hinrichsen and Holmes 20094): \\[\n\\text{Process equation:}\\quad {T_j = \\text{T}_{j-1} + r + p_j} \\quad \\text{where}\\; p_j \\,\\text ~\\, MVN(0,Q_j)\n\\] \\[\n\\text{Observation equation:}\\quad {B_j = Z +T_j + a + o_j} \\quad \\text{where}\\; o_j \\,\\text ~\\, MVN(0,R_j)\n\\] where \\(Q_j\\) is the process variance-covariance matrix, \\(R_j\\) is the observation variance-covariance matrix, \\(Z\\) is a matrix that maps sets of time series to the set of state vectors, and \\(a\\) is a vector of scaling parameters. The multivariate setting would allow the analysis of each time series as an individual population.\nPosterior distributions of the model parameters are numerically derived using Markov chain Monte Carlo (MCMC) simulation in JAGS (Plummer, 20035; 20176).The MCMC simulations are based on 10,000 samples of 2 chains. Every other sample was retained to reduce auto-correlation, and the first 1000 samples of each chain were discarded as burn-in.\nFrom the model outputs, we are most interested in \\(r\\), the annual population growth rate, \\(Q\\), the process variance, and \\(\\text{T}_{final}\\), the estimated true log Annual Nesters for the final year of observed data. Posterior distributions of Annual Nesters for the final found years of data are used to estimate current abundance: \\[\n\\text{N}_{current} = \\frac{RI * (e^{\\text{T}_{final}})+(e^{\\text{T}_{final-1}})+(e^{\\text{T}_{final-2}})+(e^{\\text{T}_{final-3}})}{4}\n\\] where \\(RI\\) is the remigration interval for the population and \\(\\text{N}_{final}\\) is the median Annual Nesters estimated for the final year of data, \\(\\text{N}_{final-1}\\) is for the second to final year of data, and so on. This serves as a snapshot of Total Reproductive Females in the population, and assumes no mortaily of adults females during the \\(RI\\) period.",
    "crumbs": [
      "Retrospective trend"
    ]
  },
  {
    "objectID": "content/s4_take/take.html",
    "href": "content/s4_take/take.html",
    "title": "Fishery take",
    "section": "",
    "text": "In principle, the incorporation of fisheries interactions into the PVA projections is simple: during the calculation of the number of females in the next time step (\\(\\text{N}_{j+1}\\)), the number of females in the current time step (\\(N_j\\)) is reduced by the incidental take in the current time step (\\(F_j\\)) and multiplied by the finite population growth rate (\\(\\lambda\\), = \\(e^r\\)). \\[\n\\text{N}_{j+1} = (N_j - F_j) * e^r\n\\] Therefore, the challenge comes from converting the incidental take of a given species (comprised of various lengths, ages, life stages, and sexes) to adult nester equivalents (ANE).\n1. Predicting anticipated take levels: The first goal is to generate the number and characteristics of the anticipated turtles that will be taken in each year. The number of turtles is referred to as the anticipated take level (ATL). Each year’s ATL was drawn from a Conway-Maxwell Poisson distribution (CMP), a two-parameter version of the Poisson distributions that includes a scale parameter \\(\\nu\\). \\(\\mu_{s,j}\\) is the mean of the CMP distribution, and \\(s\\) is one of three within-year segments which are summed to produce the total annual ATL (McCracken 20181). \\[\n\\text{ATL}_{j} \\; \\text~ \\sum^{3}_{s=1}{CMP(\\mu_{s,j},\\nu_{s,j})}\n\\] Each individual in the annual ATL receives (1) a length and fishery mortality from a bivariate normal distribution, (2) a back-calculated age with years until maturity based on a von Bertalanffy growth model, (3) juvenile survival rate, (4) sex, and (5) a remigration interval.\n2. Lengths and fishery mortality. Based on historic incidental take, a bivariate normal distribution is used to generate lengths in logarithmic space and assign fishery mortality in logit space. \\(\\theta_{L,j}\\) is a linear function of the annual incidental take (\\(F_j\\)) with intercept \\(a_0\\) and slope \\(a_1\\), and \\(\\sum\\) is the variance-covariance matrix with variances \\(\\sigma_L^2\\) and \\(\\sigma_D^2\\) for the log lengths (log(\\(L_k\\))) and logit assigned fishery mortality (logit(\\(D_k\\))) to have correlated draws. The parameters of the multivariate normal distribution (\\(a_0, a_1, \\sigma_L, \\sigma_D, \\rho_{L,D}\\)) are solved for in a Bayesian framework using STAN via RStan with 7,500 simulations per chain (5,000 burn-in, 2,500 retained) with 4 chains. \\[\n\\left( \\frac{log(L_k)}{logit(D_k)} \\right) \\;\\text~MVN\\left(\\frac{\\theta_{L,j}}{\\theta_D},\\;\\scriptstyle\\sum\\;\\right)\n\\] \\[\n\\theta_{L,j} = a_0 + a_1F_j\n\\]\n\\[\n\\scriptstyle\\sum = \\left[\\frac {\\sigma_L^2}{}{\\rho_{L,d}{}} \\right]\n\\] \\[\n\\Sigma = \\begin{pmatrix}\n\\mathrm{\\sigma_L^2} & \\mathrm{{\\rho_{L,D}}{\\sigma_{L}{\\sigma_{D}} \\\\\n\\mathrm{{\\rho_{L,D}}{\\sigma_L}{\\sigma_D}} & \\mathrm{\\sigma_D^2}\n\\end{pmatrix}\n\\]\n3. Age and stage. From all lengths of historically taken turtles, a von Bertalanffy growth model (VBGM) is used to calculate the expected length at age across the range of lengths for each species. Using the VBGM for each species, the age at maturity (\\(A_{mat}\\)) was assumed to correspond to a length of 97.5% of the maximum asymptotic maximum length (\\(L_\\infty\\)). Turtles with ages less than \\(A_{mat}\\) or lengths less than 97.5% of (\\(L_\\infty\\)) are considered immature. Years until maturity are calculated for all turtles as \\(Y_k = A_{mat} - {A_k}\\), where \\(A_k\\) is the age of the \\(k\\)th individual.\n4. Remigration interval, juvenile survival, and sex. In deterministic runs, each individual in the anticipated take is assigned the mean remigration interval (\\(RI\\)) and the mean juvenile survival (\\(\\phi\\)). In stochastic runs, each individual’s \\(RI\\) is drawn from a distribution (CMP for leatherbacks, truncated normal for loggerheads) and their juvenile survival is drawn from a normal distribution. The sex of each animal is drawn from a Bernoulli distribution for the probability of being female.\n5. ANE calculation. Adults in the anticipated take are given ANEs of 1. Juvenile ANEs are calculated by projecting the juvenile survival over the number of years to maturity, and dividing by remigration interval. The stochastic nature of sex ratio and fishery mortality are applied to adjust the individual ANE. The probability of an individual taken by a fishery dying is used with a Bernoulli distribution to simulate whether an individual dies. Therefore, the ANE of the \\(k\\)th individual is computed such that when the individual was a juvenile, female, and ended up dying, ANE was defined as the first equation below. However, when the individual was adult and either male or ends up alive, the ANE equals 0.\n\\[\nANE_k = \\frac{\\phi_J^{Y_k}}{RI}\n\\] \\[\nANE_{realized,k} = \\{{{\\frac{\\phi_J^{Y_k}}{RI}, Stage = J}\\atop{1 \\times Sex \\times Discard, Stage = A}}\n\\] 5. Historical ANE imputation. To account for the historical impact on the population growth rates, ANE is also calculated historically. Each turtle’s length is used to generate a likely age, stage, and years to maturity. Juveniles’ years to maturity are rounded to the nearest year, and adults are assumed to be nesting in the year of their fishery interaction. \\(Y_F\\) is the year incidental take occurred, \\(Y_k\\) is the yeras to maturity, RI is the remigration interval (rounded to 3 years). The survival probability between each nesting year has to be accounted for so that the initial ANE is adjusted, where \\(\\phi_J\\) and \\(\\phi_A\\) are juvenile and adult survival rates, \\(PF\\) is the proportion females, and \\(D\\) is the assigned fishery mortality. \\[\nY_{nest,k} = \\{{{Y_F+Y_k, y=1}\\atop{Y_{nest,k}-1+RI, y&gt;1}}\n\\] \\[\nANE_{k,j} = \\{{{{\\phi_J^{Nest_1}}\\times{PF} \\times D_k, y = 1}\\atop{{\\phi_A^{RI}, y&gt;1}}}\n\\] 6. Take calculation. After converting all individuals to ANEs, take (\\(F_j\\)) from the earlier equation is substituted out for the summation of the individual ANEs in a given year. To account to process variance \\(Q\\) from the trend analysis, the first equation below is modified to draw \\(N_{j+1}\\) from a normal distribution. The modified population growth model presented below is used as the basis for the future projections described above to produce future scenarios with take incorporated. \\[\n\\text{N}_{j+1} = (N_j - ANE_{realized,j}) * e^r\n\\] \\[\n\\text{N}_{j+1} = N((N_j - ANE_{realized,j}) * e^r, Q)\n\\]",
    "crumbs": [
      "Fishery take"
    ]
  },
  {
    "objectID": "content/s4_take/take.html#footnotes",
    "href": "content/s4_take/take.html#footnotes",
    "title": "Fishery take",
    "section": "Footnotes",
    "text": "Footnotes\n\n\nMcCracken ML. 2018. Hawaii permitted shallow-set longline fishery estimated anticipated take level for Endangered Species Act listed species. In: NOAA Fisheries Pacific Islands Science Center, editor. Honolulu, HI USA↩︎",
    "crumbs": [
      "Fishery take"
    ]
  },
  {
    "objectID": "content/s3_future/future.html",
    "href": "content/s3_future/future.html",
    "title": "Future projections",
    "section": "",
    "text": "PVA projections use a simulation approach with 10,000 runs for each species. Each projection is initialized in its starting year with a paired draw from the MCMC samples (joint posterior distribution) for (1) Annual Nesters (\\(N_0\\) = \\(\\text{N}_{final}\\)), (2) instantaneous population growth rate (\\(r\\)), (3) process error variance (\\(Q\\)) from the final data year of the historic trend analysis. For each subsequent year in the projection, a new \\(r\\) and \\(Q\\) are drawn as pairs from the MCMC samples to make the projections dynamic. Pulling paired draws from the MCMC samples reflects the inter-annual variation in the biology of the species, but also constrains parameter values to realistic combinations and therefore keeps the uncertainty in the projections reasonable.\nProjections can be evaluated against abundance thresholds. Here, the probability of falling below 50%, 25%, and 12.5% of current population size (\\(N_0\\)) is calculated at 5, 10, 25, 50, and 100-year time steps by summing the number of projections below the thresholds at the given time step and dividing by the total number of projections (10,000). Mean, median, and 95% confidence limits of number of years to reach the threshold are calculated for simulations that fall below a given population threshold, and the 100-year timestep simulation.\n\nModeling assumptions\nThe population will face the same threats in the future as it did in the past. The PVA applies the population growth rate from the past, which was influenced by some particular magnitude of threats, to the future trajectory of the population. It does not account for the impacts of new or increasing threats, such as the loss of nesting habitat from climate change.",
    "crumbs": [
      "Future projections"
    ]
  },
  {
    "objectID": "content/s2_retrospective/retro.html#footnotes",
    "href": "content/s2_retrospective/retro.html#footnotes",
    "title": "Retrospective trend analysis",
    "section": "Footnotes",
    "text": "Footnotes\n\n\nBoyd, C., D. P. DeMaster, R. S. Waples, E. J. Ward, and B. L. Taylor. 2017. Consistent extinction risk assessment under the US Endangered Species Act. Conservation Letters 10:328-336.↩︎\nHolmes EE, Sabo JL, Viscido SV, Fagan WF. 2007. A statistical approach to quasi‐extinction forecasting. Ecology Letters. 10(12):1182-1198.↩︎\nBoyd, C., D. P. DeMaster, R. S. Waples, E. J. Ward, and B. L. Taylor. 2017. Consistent extinction risk assessment under the US Endangered Species Act. Conservation Letters 10:328-336.↩︎\nHinrichsen R, Holmes EE. 2009. Using multivariate state-space models to study spatial structure and dynamics. Spatial Ecology.145-166.↩︎\nPlummer M. 2003. Jags: A program for analysis of bayesian graphical models using Gibbs sampling. Proceedings of the 3rd international workshop on distributed statistical computing. Vienna, Austria.↩︎\nPlummer M. 2017. Jags version 4.3.0 user manual. http://mcmc-jagssourceforgenet/.↩︎",
    "crumbs": [
      "Retrospective trend"
    ]
  },
  {
    "objectID": "content/flow.html",
    "href": "content/flow.html",
    "title": "flow",
    "section": "",
    "text": "Flow diagram (test)\n\n\n\n\n\nflowchart LR\n  A[Population size] --&gt; B[No] & C[Yes]\n  B --&gt; D[Direct data] & E[Indirect data]\n  D --&gt; F[Nesting female counts]\n  E --&gt; G[Nest counts]\n  G --&gt; H[Perfect nest counts] & I[Imperfect nest counts]\n  I --&gt; J[Nest count imputation]\n  \n click J \"https://pifsc-protected-species-division.github.io/population_assessment/content/s1_imputation/imputation.html\" \"Go to Nest Imputation\"",
    "crumbs": [
      "Flow diagram"
    ]
  }
]